# AES-CBC LoRa ESP32
LoRa PPP communication with payload encryption using AES-CBC via API of mbedTLS
Compatible with ESP32 microcontrollers and LoRa modules (SX127X). Arduino_LoRa library for PPP LoRa transmission

# Hardware
* Sender: Lolin32
* Receiver: ESP32-C6 (XIAO)
![image](https://github.com/user-attachments/assets/510878b8-b1d3-4297-a229-9c4a8b2db242)

# AES key
* Both devices has the same AES encryption / descryption 256-bit key

# Structure of data
* 17 bytes of data (double, double, byte - mapped as 24 bytes in memory) to demonstrate padding via PKCS#7 to get 2 blocks (32 B in total)
* CBC with XOR of IV and first open block and then XOR of ciphertext with next open block

# Payload structure
* First 16 bytes is IV in plaintext which is generated by sender
* Next 32 bytes are encrypted data - ciphertext sent by sender
* 48 bytes in total

# Receiver
* Validation if packet is longer than IV
* IV is parsed, then rest of the ciphertext is decrypted
* And we have the original data parsed based on byte length per data type
* Firmware demonstrates also the different ciphertext for the identical payload due of XOR operations and IV generated by RNG on sender side

# Note
* AES-CBC allows you do encrypt data to not let other person to read them
* Encrypted is just the payload, everything else is a plaintext and readable to anyone in LoRa range
* AES-CBC does not implement any data integrity or authenticity mechanism!
* Receiver does not have any function to check, from what device packet came
